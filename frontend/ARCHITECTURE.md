# Authentication Flow Diagram

## ðŸ” Complete Authentication Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AUTHENTICATION FLOW                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser    â”‚         â”‚   Express    â”‚         â”‚ JSON Databaseâ”‚
â”‚  (Frontend)  â”‚         â”‚   (Backend)  â”‚         â”‚  (Storage)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          REGISTRATION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       â”‚                        â”‚                        â”‚
       â”‚ 1. Fill register form  â”‚                        â”‚
       â”‚    /auth/register/     â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 2. POST /api/auth/     â”‚                        â”‚
       â”‚    register            â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚    {username, email,   â”‚                        â”‚
       â”‚     password}          â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 3. Hash password       â”‚
       â”‚                        â”‚    with bcrypt         â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 4. Check if user existsâ”‚
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 5. Read user.json      â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 6. Save new user       â”‚
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 7. Write user.json     â”‚
       â”‚                        â”‚    (password hashed)   â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 8. Create session      â”‚
       â”‚                        â”‚    (Passport.js)       â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 9. Success response    â”‚                        â”‚
       â”‚    + Set-Cookie        â”‚                        â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ {success: true,        â”‚                        â”‚
       â”‚  user: {...}}          â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚10. Cache in localStorage                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚11. Redirect to /       â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             LOGIN FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       â”‚                        â”‚                        â”‚
       â”‚ 1. Fill login form     â”‚                        â”‚
       â”‚    /auth/login/        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 2. POST /api/auth/loginâ”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚    {username, password}â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 3. Find user by username
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 4. Read user.json      â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 5. Compare password    â”‚
       â”‚                        â”‚    bcrypt.compare()    â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 6. Create session      â”‚
       â”‚                        â”‚    (Passport.js)       â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 7. Success response    â”‚                        â”‚
       â”‚    + Set-Cookie        â”‚                        â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ {success: true,        â”‚                        â”‚
       â”‚  user: {...}}          â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 8. Cache in localStorage                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 9. Redirect to /       â”‚                        â”‚
       â”‚                        â”‚                        â”‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          GET USER FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       â”‚                        â”‚                        â”‚
       â”‚ 1. GET /api/auth/user  â”‚                        â”‚
       â”‚    + Cookie            â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 2. Deserialize session â”‚
       â”‚                        â”‚    passport.js         â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 3. Find user by ID     â”‚
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 4. Read user.json      â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                        â”‚                        â”‚
       â”‚ 5. User data (no pwd)  â”‚                        â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ {success: true,        â”‚                        â”‚
       â”‚  user: {...}}          â”‚                        â”‚
       â”‚                        â”‚                        â”‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           LOGOUT FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       â”‚                        â”‚                        â”‚
       â”‚ 1. POST /api/auth/logout                        â”‚
       â”‚    + Cookie            â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚ 2. Destroy session     â”‚
       â”‚                        â”‚    req.logout()        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 3. Success + Clear Cookie                       â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚ 4. Clear localStorage  â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        COMPONENT BREAKDOWN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Frontend Components:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /auth/login/index.html                             â”‚
â”‚ â”œâ”€ Form with username & password inputs            â”‚
â”‚ â””â”€ Submit button                                   â”‚
â”‚                                                     â”‚
â”‚ /auth/login/main.js                                â”‚
â”‚ â”œâ”€ handleSubmit() - Form submission handler        â”‚
â”‚ â”œâ”€ login() - Calls AuthService.login()             â”‚
â”‚ â””â”€ Error handling & UI feedback                    â”‚
â”‚                                                     â”‚
â”‚ /auth/register/index.html                          â”‚
â”‚ â”œâ”€ Form with username, email & password            â”‚
â”‚ â””â”€ Submit button                                   â”‚
â”‚                                                     â”‚
â”‚ /auth/register/main.js                             â”‚
â”‚ â”œâ”€ handleSubmit() - Form submission handler        â”‚
â”‚ â”œâ”€ registerUser() - Calls AuthService.register()   â”‚
â”‚ â””â”€ Error handling & success messages               â”‚
â”‚                                                     â”‚
â”‚ /utils/user.js (AuthService)                       â”‚
â”‚ â”œâ”€ register() - POST /api/auth/register            â”‚
â”‚ â”œâ”€ login() - POST /api/auth/login                  â”‚
â”‚ â”œâ”€ getUser() - GET /api/auth/user                  â”‚
â”‚ â”œâ”€ updateUser() - PUT /api/auth/user               â”‚
â”‚ â””â”€ logout() - POST /api/auth/logout                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Backend Components:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/index.js (Main Server)                         â”‚
â”‚ â”œâ”€ Express app setup                               â”‚
â”‚ â”œâ”€ Session middleware                              â”‚
â”‚ â”œâ”€ Passport initialization                         â”‚
â”‚ â””â”€ Routes mounting                                 â”‚
â”‚                                                     â”‚
â”‚ src/config/passport.js                             â”‚
â”‚ â”œâ”€ LocalStrategy configuration                     â”‚
â”‚ â”œâ”€ User validation logic                           â”‚
â”‚ â”œâ”€ Serialize/deserialize user                      â”‚
â”‚ â””â”€ Helper functions (readUsers, writeUsers)        â”‚
â”‚                                                     â”‚
â”‚ src/routes/auth.js                                 â”‚
â”‚ â”œâ”€ POST /register - Create new user                â”‚
â”‚ â”œâ”€ POST /login - Authenticate user                 â”‚
â”‚ â”œâ”€ POST /logout - End session                      â”‚
â”‚ â”œâ”€ GET /user - Get current user                    â”‚
â”‚ â””â”€ PUT /user - Update user profile                 â”‚
â”‚                                                     â”‚
â”‚ src/middleware/auth.js                             â”‚
â”‚ â”œâ”€ isAuthenticated() - Protect routes              â”‚
â”‚ â””â”€ isNotAuthenticated() - Redirect if logged in    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Storage:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSONDatabase/user.json                             â”‚
â”‚ â”œâ”€ Array of user objects                           â”‚
â”‚ â”œâ”€ Hashed passwords (bcrypt)                       â”‚
â”‚ â””â”€ User metadata (email, imageUrl, etc)            â”‚
â”‚                                                     â”‚
â”‚ Browser localStorage                               â”‚
â”‚ â”œâ”€ Cached user data (quick access)                 â”‚
â”‚ â””â”€ No sensitive data (passwords excluded)          â”‚
â”‚                                                     â”‚
â”‚ Session Store (in-memory)                          â”‚
â”‚ â”œâ”€ Active user sessions                            â”‚
â”‚ â””â”€ Cookie-based session management                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         SECURITY FEATURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Password Hashing
   â””â”€ bcrypt with salt rounds = 10
   â””â”€ Passwords never stored in plain text

âœ… Session Management
   â””â”€ HTTP-only cookies (prevents XSS)
   â””â”€ Secure flag in production
   â””â”€ 24-hour expiration

âœ… Password Validation
   â””â”€ bcrypt.compare() for secure comparison
   â””â”€ Timing-attack resistant

âœ… API Security
   â””â”€ Authentication required for protected routes
   â””â”€ Password never sent to client
   â””â”€ Session-based authentication

âœ… Error Handling
   â””â”€ Generic error messages (prevent user enumeration)
   â””â”€ Detailed errors only in console
   â””â”€ User-friendly feedback


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        REQUEST/RESPONSE FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Login Request:
POST /api/auth/login HTTP/1.1
Content-Type: application/json

{
  "username": "example_user",
  "password": "securepassword123"
}

â†“

Login Response:
HTTP/1.1 200 OK
Set-Cookie: connect.sid=...; Path=/; HttpOnly
Content-Type: application/json

{
  "success": true,
  "message": "Logged in successfully",
  "user": {
    "id": 1,
    "username": "example_user",
    "email": "example_user@example.com",
    "imageUrl": "https://example.com/images/example_user.png",
    "createdAt": "2023-10-01T11:00:00Z"
  }
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

This architecture provides a complete, secure authentication system using
industry-standard practices with Passport.js and Express sessions.
